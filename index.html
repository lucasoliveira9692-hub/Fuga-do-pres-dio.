<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Fuga do Presídio</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { background:#111; color:#fff; font-family:Arial, sans-serif; margin:0; text-align:center; }
    h1 { margin-top:18px; font-size:28px; }
    #gameArea { margin:20px auto; width:90%; height:400px; border:3px solid #fff; background:#222; display:flex; align-items:center; justify-content:center; }
    #status { color:#bbb; }
    #error { color:#ff6b6b; margin-top:12px; display:none; }
  </style>
</head>
<body>
  <h1>Fuga do Presídio</h1>

  <div id="gameArea">
    <div>
      <div id="status">Carregando jogo...</div>
      <div id="error"></div>
    </div>
  </div>

  <script>
    // 1) tentar desregistrar service workers (temporário)
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations().then(regs => {
        regs.forEach(r => {
          r.unregister().then(() => console.log('Service worker desregistrado')).catch(e=>console.warn('Erro ao desregistrar SW', e));
        });
      }).catch(e => console.warn('Erro ao obter SW regs', e));
    }

    // 2) função para mostrar erro na tela + console
    function mostrarErro(msg) {
      console.error(msg);
      document.getElementById('status').style.display = 'none';
      const e = document.getElementById('error');
      e.style.display = 'block';
      e.textContent = 'Erro: ' + msg;
    }

    // 3) criar elemento script com cache-bust
    (function loadGame() {
      const s = document.createElement('script');
      // ajuste o nome abaixo para o seu arquivo: jogo.js ou game.js
      s.src = 'jogo.js?v=1';
      s.defer = true;
      s.onload = function() {
        console.log('jogo.js carregado com sucesso');
        document.getElementById('status').textContent = 'Jogo carregado. Iniciando...';
        // se seu jogo tem função init, chame-a aqui, por exemplo: if(window.initGame) window.initGame();
      };
      s.onerror = function(e) {
        mostrarErro('Falha ao carregar jogo.js (verifique nome/rota). Veja console para detalhes.');
      };
      document.head.appendChild(s);

      // timeout: se nada carregar em 6s, mostra erro
      setTimeout(()=> {
        // se o script não definiu uma flag global, avisa
        if(!window.__lcgame_loaded) {
          mostrarErro('Tempo esgotado: script não inicializou. Confira o nome do arquivo e abra o console.');
        }
      }, 6000);
    })();

    // 4) capturar erros runtime e mostrar no console/tela
    window.addEventListener('error', function(evt){
      console.error('Erro runtime:', evt.error || evt.message);
      document.getElementById('error').style.display = 'block';
      document.getElementById('error').textContent = 'Erro no JavaScript: ' + (evt.error?.message || evt.message || evt.filename);
    });
  </script>

</body>
</html>
